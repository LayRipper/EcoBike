First working solution, got room for refactoring
